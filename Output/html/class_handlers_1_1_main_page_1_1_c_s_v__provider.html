<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GreenHouse Monitoring System: Handlers.MainPage.CSV_provider Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GreenHouse Monitoring System
   &#160;<span id="projectnumber">1</span>
   </div>
   <div id="projectbrief">A monitor for a greenhouse</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_handlers.html">Handlers</a></li><li class="navelem"><a class="el" href="namespace_handlers_1_1_main_page.html">MainPage</a></li><li class="navelem"><a class="el" href="class_handlers_1_1_main_page_1_1_c_s_v__provider.html">CSV_provider</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_handlers_1_1_main_page_1_1_c_s_v__provider-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Handlers.MainPage.CSV_provider Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for Handlers.MainPage.CSV_provider:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_handlers_1_1_main_page_1_1_c_s_v__provider.png" usemap="#Handlers.MainPage.CSV_5Fprovider_map" alt=""/>
  <map id="Handlers.MainPage.CSV_5Fprovider_map" name="Handlers.MainPage.CSV_provider_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9313d5d43eeb21d5100833d364d02d7b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_handlers_1_1_main_page_1_1_c_s_v__provider.html#a9313d5d43eeb21d5100833d364d02d7b">get</a> (self)</td></tr>
<tr class="separator:a9313d5d43eeb21d5100833d364d02d7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7257533ba7a6dcce78f30061a1d6aa62"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_handlers_1_1_main_page_1_1_c_s_v__provider.html#a7257533ba7a6dcce78f30061a1d6aa62">form_csv</a> (self, sensor_type)</td></tr>
<tr class="separator:a7257533ba7a6dcce78f30061a1d6aa62"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">    Retrieves current year measuress from DB of specified sensor type and gives it to client in a CSV file
    
    Uses a GET parameter sensor_type to know which sensor type to fetch from DB and only gets current year measures
    No parameters
    It inherits from webapp2.RequestHandler
    In this case is used only it's "get" method which responds to a GET request
</pre> </div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a7257533ba7a6dcce78f30061a1d6aa62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7257533ba7a6dcce78f30061a1d6aa62">&sect;&nbsp;</a></span>form_csv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def Handlers.MainPage.CSV_provider.form_csv </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sensor_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Extract data from objects and format it as CSV string</pre> <div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keyword">def </span>form_csv(self,sensor_type):</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Extract data from objects and format it as CSV string&quot;&quot;&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        this_year_measures = CensadoHandler.get_this_year_measures(sensor_type)</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        csv_string = <span class="stringliteral">&#39;,&#39;</span>.join([<span class="stringliteral">&#39;Tipo_sensor&#39;</span>,<span class="stringliteral">&#39;Valor&#39;</span>,<span class="stringliteral">&#39;Fecha&#39;</span>,<span class="stringliteral">&#39;id-LiSANDRA_(Ubicacion)&#39;</span>]) <span class="comment">#Title headers</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        csv_string+=<span class="stringliteral">&#39;\n&#39;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <span class="keywordflow">for</span> sensor_entity <span class="keywordflow">in</span> this_year_measures:</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            csv_string+= <span class="stringliteral">&#39;,&#39;</span>.join([sensor_entity.type, str(sensor_entity.value), str(sensor_entity.when), str(sensor_entity.id_LiSANDRA)])</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            csv_string+=<span class="stringliteral">&#39;\n&#39;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="keywordflow">return</span> csv_string   </div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        </div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        </div></div><!-- fragment -->
</div>
</div>
<a id="a9313d5d43eeb21d5100833d364d02d7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9313d5d43eeb21d5100833d364d02d7b">&sect;&nbsp;</a></span>get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def Handlers.MainPage.CSV_provider.get </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keyword">def </span>get(self):</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        sensor_type = self.request.get(<span class="stringliteral">&quot;sensor_type&quot;</span>) <span class="comment">#Retrieves the &quot;sensor_type&quot; parameter, from get request</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        self.response.headers[<span class="stringliteral">&#39;Content-Type&#39;</span>] = <span class="stringliteral">&#39;text/csv&#39;</span> <span class="comment">#Defines kind of data sent</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        content_disp_str = <span class="stringliteral">&quot;attachment; filename=&quot;</span>+sensor_type+<span class="stringliteral">&quot;_values.csv&quot;</span> <span class="comment">#Adds the name to the file</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        self.response.headers[<span class="stringliteral">&#39;Content-Disposition&#39;</span>] = str(content_disp_str) </div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        self.response.write(self.form_csv(sensor_type)) <span class="comment">#Send response to the client</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        </div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        </div></div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="_main_page_8py.html">MainPage.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
